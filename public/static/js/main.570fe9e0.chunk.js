(this["webpackJsonpdartboard-frontend"]=this["webpackJsonpdartboard-frontend"]||[]).push([[0],{100:function(e,t,r){},101:function(e,t,r){},102:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r(0),c=r.n(a),s=r(38),o=r.n(s),u=r(39),i=r.n(u),l=r(1),m=function(e,t){switch(t.type){case"update_state":return e.publicKey===t.data.publicKey?Object(l.a)({},e,{state:t.data.state}):e;case"check_room_response":return Object(l.a)({},e,{roomStatus:{shortCode:t.shortCode,publicKey:t.publicKey}});case"create_room_response":return Object(l.a)({},e,{state:t.response.state,publicKey:t.response.publicKey,shortCode:t.response.shortCode});case"join_room_response":return Object(l.a)({},e,{loading:!1,state:t.response.state,publicKey:t.response.publicKey,shortCode:e.roomStatus.shortCode});default:return e}},d=(r(77),function(e){var t=e.shortCode,r=e.publicKey;return t&&!r?"This room code doesn't exist. (Codes expire after 24 hours.)":null}),p=function(e){var t=e.checkRoom,r=e.roomStatus,a=e.joinRoom,s=e.selectGame,o=c.a.useState(""),u=Object(n.a)(o,2),i=u[0],l=u[1];return c.a.createElement("div",{className:"landing-container"},c.a.createElement("div",{className:"landing-text"},c.a.createElement("p",null,"Hey, this is ",c.a.createElement("strong",null,"DistanceDarts"),". ",c.a.createElement("br",null)," It\u2019s a tiny website that helps people keep score when they\u2019re playing webcam darts against each other."),c.a.createElement("p",null,"Everything works off short room codes, kind of like Jackbox games - you can create a game and send the code to your friends, and everyone can track the scores and statistics."),c.a.createElement("p",null,"When you record someone\u2019s throw, it updates for everyone else in real time. We\u2019ve used it to play a few tournaments and it\u2019s worked pretty well so far."),c.a.createElement("p",null,"A few other sites do the same sort of thing, but I tried to streamline the UI and make this easy and fun to use, and ensure it works with whatever kind of setup you\u2019ve got. Also, it\u2019s extremely free, forever."),c.a.createElement("p",null,"Bugs or feature requests? Hit me up on twitter, I\u2019m"," ",c.a.createElement("a",{href:"https://twitter.com/kylehill",rel:"noopener noreferrer",target:"_blank"},"@kylehill"),".")),c.a.createElement("div",{className:"landing-join"},"Join a room:",c.a.createElement("div",{className:"landing-join-controls"},c.a.createElement("input",{type:"text",value:i,placeholder:"Room Code",onChange:function(e){var r=e.target.value.toUpperCase();l(r),t(r)}}),c.a.createElement("button",{disabled:!r.publicKey,onClick:function(){r.publicKey&&a()}},"Join Room"),d(r)&&c.a.createElement("div",{className:"error-text"},d(r)))),c.a.createElement("div",{className:"landing-create"},"Create a new game:",c.a.createElement("div",{className:"landing-create-buttons"},c.a.createElement("button",{className:"button-cricket",onClick:function(){return s("cricket")}},"Cricket"),c.a.createElement("button",{className:"button-x01",onClick:function(){return s("x01")}},"X01"),c.a.createElement("button",{className:"button-clocky",disabled:!0,onClick:function(){return s("clocky")}},"Clocky"))))},f=(r(78),function(e){var t=e.name,r=e.value,a=e.setValue,s=e.optionsObject;return c.a.createElement("select",{className:"config-dropdown",value:r,onChange:function(e){a(t,e.target.value)}},Object.entries(s).map((function(e,t){var r=Object(n.a)(e,2),a=r[0],s=r[1];return c.a.createElement("option",{key:t,value:a},s)})))}),h=function(e){var t=e.variants,r=e.setVariant;return c.a.createElement("div",{className:"setup-config-container"},"Start a game of ",c.a.createElement(f,{name:"format",value:t.format||"standard",setValue:r,optionsObject:{standard:"Standard Cricket","no-points":"Cricket, No Points"}}),".")},v=function(e){var t=e.variants,r=e.setVariant;return c.a.createElement("div",{className:"setup-config-container"},c.a.createElement("p",null,"Start a game of ",c.a.createElement(f,{name:"target",value:t.target||"501",setValue:r,optionsObject:{301:"301",401:"401",501:"501",701:"701",901:"901",1001:"1001"}}),"."),c.a.createElement("p",null,"Players ",c.a.createElement(f,{name:"start",value:t.start||"single",setValue:r,optionsObject:{single:"don't need to double in",double:"need to double in"}})," and ",c.a.createElement(f,{name:"end",value:t.end||"double",setValue:r,optionsObject:{single:"don't need to double out",double:"need to double out"}}),"."),c.a.createElement("p",null,"By default, this app tracks attempts at doubling in and out. ",c.a.createElement(f,{name:"trackDoubles",value:t.trackDoubles||"yes",setValue:r,optionsObject:{yes:"Keep that enabled.",no:"Disable double tracking."}})))},b={target:"501",teams:"singles",start:"single",end:"double",trackDoubles:"yes"},k=(r(79),function(e){switch(e){case 0:return"red";case 1:return"blue";case 2:return"green";case 3:return"orange";case 4:return"purple";case 5:default:return"pink"}}),g=function(e,t){switch(e){case"easy":return"CPU Easy";case"medium":return"CPU Medium";case"hard":return"CPU Hard";case!1:default:return"Player ".concat(t+1)}},E=function(e){var t=e.color,r=e.player,n=e.position,a=e.minPlayers,s=e.updatePlayer,o=e.removePlayer,u=e.includeCpu;return c.a.createElement("div",{className:"setup-player setup-player-".concat(t)},c.a.createElement("input",{className:"setup-player-name",value:r.name,onChange:function(e){s(n,Object(l.a)({},r,{name:e.target.value}))}}),u&&c.a.createElement("button",{className:"setup-player-cpu",onClick:function(){var e=function(e){switch(e.cpu){case"easy":return"medium";case"medium":return"hard";case"hard":return!1;case!1:default:return"easy"}}(r);s(n,Object(l.a)({},r,{cpu:e,name:g(e,n)}))}},function(e){switch(e.cpu){case"easy":return"\ud83d\udcbb";case"medium":return"\ud83e\udd16";case"hard":return"\ud83d\udc7e";case!1:default:return"\ud83d\udc64"}}(r)),n>=a&&c.a.createElement("button",{className:"setup-player-remove",onClick:function(){o(n)}},"\u2573"))},y=function(e){var t=e.players,r=e.setPlayers,n=e.doubles,a=e.minPlayers,s=e.maxPlayers,o=e.includeCpu,u=function(e,n){r(t.map((function(t,r){return r===e?n:t})))},i=function(e){r(t.filter((function(t,r){return r!==e})))};return c.a.createElement("div",{className:"setup-players"},t.map((function(e,t){return c.a.createElement(E,{color:k(t),key:t,player:e,position:t,minPlayers:a,updatePlayer:u,removePlayer:i,includeCpu:o})})),t.length<s&&c.a.createElement("button",{onClick:function(){r(n?t.concat([{cpu:!1,name:"Player ".concat(t.length+1)},{cpu:!1,name:"Player ".concat(t.length+2)}]):t.concat({cpu:!1,name:"Player ".concat(t.length+1)}))},className:"setup-players-create"},"Add Player"))},w=(r(80),function(e){var t=e.shortCode,r=e.publicKey;return t&&r?"This room code is in use.":null}),N=function(e){var t=e.checkRoom,r=e.roomStatus,a=c.a.useState(""),s=Object(n.a)(a,2),o=s[0],u=s[1];return c.a.createElement("div",{className:"setup-room"},c.a.createElement("input",{type:"text",value:o,placeholder:"Room code",onChange:function(e){var r=e.target.value.toUpperCase();u(r),t(r)}}),c.a.createElement("button",{onClick:function(){var e=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(34).toUpperCase().split("").reverse().filter((function(e){return isNaN(e)})).slice(0,4).map((function(e){switch(e){case"I":return"Y";case"O":return"Z";default:return e}})).join("");u(e),t(e)}},"Random Code"),w(r)&&c.a.createElement("div",{className:"error-text"},w(r)))},T=r(5),x=r.n(T),j=r(13),O=function(){var e=Object(j.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){return e.split("-").map((function(e){return e[0].toUpperCase()+e.split("").slice(1).join("").toLowerCase()})).join(" ")},_=(r(82),function(e,t,r){switch(e){case"cricket":return function(e,t){return function(e){var t=e.roomCode,r=e.players,n=e.variants,a=e.title;return{legs:r.map((function(e){return 0})),stats:r.map((function(e){return{darts:0,hits:0,marks:0,mpr:0,hitRate:0,turns:[0,0,0,0,0,0,0,0,0,0]}})),scores:[{points:0,marks:[0,0,0,0,0,0,0]},{points:0,marks:[0,0,0,0,0,0,0]}],roomCode:t,title:a||"Room Code: ".concat(t),isActive:!0,tx:0,game:"cricket",players:r,variants:n,firstThrow:0,currentThrow:0,priorTurns:[],priorLegs:[],currentTurn:[],winner:null,cpuControl:!!r[0].cpu}}({roomCode:t,players:e.players,variants:e.variants,title:""})}(t,r);case"x01":return function(e,t){var r=Object(l.a)({},b,{},e.variants),n=e.players.map((function(e){return 0})),a=e.players.map((function(e){return Number(r.target)}));return{legs:n,stats:e.players.map((function(e){return{all:{darts:0,points:0},f9:{darts:0,points:0},turns:{},checkouts:[],doubleIn:{misses:0,hits:0},doubleOut:{misses:0,hits:0}}})),scores:a,variants:r,roomCode:t,isActive:!0,tx:0,game:"x01",players:e.players,firstThrow:0,currentThrow:0,priorTurns:[],priorLegs:[],currentTurn:{score:"",doubleDart:!1},winner:null,title:"Room Code: ".concat(t)}}(t,r);default:return null}}),D=function(e,t){switch(t.type){case"set_variant":var r=function(e,t,r){if(void 0===r)return Object.entries(e).reduce((function(e,r){var a=Object(n.a)(r,2),c=a[0],s=a[1];return c!==t&&(e[c]=s),e}),{});var a=Object.entries(e).reduce((function(e,t){var r=Object(n.a)(t,2),a=r[0],c=r[1];return e[a]=c,e}),{});return a[t]=r,a}(e.variants,t.key,t.value);return Object(l.a)({},e,{variants:r});case"set_players":return Object(l.a)({},e,{players:t.players});default:return e}},R=function(e){var t=e.game,r=e.checkRoom,a=e.roomStatus,s=(e.clearGame,e.createRoom),o=c.a.useReducer(D,{variants:{},players:[{cpu:!1,name:"Player 1"},{cpu:!1,name:"Player 2"}]}),u=Object(n.a)(o,2),i=u[0],l=u[1],m="cricket"===t?2:6,d="cricket"===t?2:1;return c.a.createElement("div",{className:"setup-container setup-container-".concat(t)},c.a.createElement("div",{className:"setup-config"},function(e,t,r){switch(e){case"cricket":return c.a.createElement(h,{variants:t,setVariant:r});case"x01":return c.a.createElement(v,{variants:t,setVariant:r});default:return null}}(t,i.variants,(function(e,t){l({type:"set_variant",key:e,value:t})}))),c.a.createElement(y,{players:i.players,setPlayers:function(e){l({type:"set_players",players:e})},minPlayers:d,maxPlayers:m,includeCpu:"cricket"===t}),c.a.createElement(N,{checkRoom:r,roomStatus:a}),c.a.createElement("button",{disabled:!a.shortCode||!!a.publicKey,className:"setup-create",onClick:function(){var e=_(t,i,a.shortCode);s(e)}},"Start Game"))},M=function(e){var t=e.checkRoom,r=e.roomStatus,a=e.joinRoom,s=e.createRoom,o=c.a.useState(null),u=Object(n.a)(o,2),i=u[0],l=u[1];return i?c.a.createElement(R,{game:i,clearGame:function(){return l(null)},checkRoom:t,roomStatus:r,createRoom:s}):c.a.createElement(p,{joinRoom:a,checkRoom:t,roomStatus:r,selectGame:l})},S=(r(83),function(e){var t=e.spectating,r=e.clickChange;return c.a.createElement("div",{className:"spectate-mode"},t&&c.a.createElement("div",{className:"spectate-copy"},"You are currently ",c.a.createElement("strong",null,"spectating"),".",c.a.createElement("br",null),"Click the button to the right to switch to scoring mode."),!t&&c.a.createElement("div",{className:"spectate-copy"},"You are currently ",c.a.createElement("strong",null,"scoring")," and can mark the scoreboard.",c.a.createElement("br",null),"Click the button to the right to switch to spectate mode."),c.a.createElement("button",{className:"spectate-button spectate-button-".concat(t?"spectating":"scoring"),onClick:r},t?"\ud83d\udc40":"\ud83c\udfaf"))}),L=(r(84),function(e){var t=e.currentThrow;return e.winner?null:c.a.createElement("div",{className:"active-icon active-icon-".concat(t)},"\u25b8")}),P=["20","19","18","17","16","15","B"],B=function(e){var t=e.value,r=e.changeName;return c.a.createElement("input",{className:"cricket-name",value:t,onChange:function(e){return r(e.target.value)}})},I=function(e){var t=e.marks,r=function(e,t){switch(e){case 0:return P[t];case 1:return"/";case 2:return"X";case 3:default:return"\u2713"}}(t,e.sector);return c.a.createElement("div",{className:"cricket-cell cricket-marks ".concat(t>=3?"cricket-marks-complete":""," ").concat(0===t?"cricket-marks-empty":"")},r)},F=function(e){var t=e.changeName,r=e.cpu,n=e.name,a=e.marks,s=e.points,o=e.legs,u=e.firstThrow,i=e.trailing,l=e.winner;return c.a.createElement("div",{className:"cricket-player"},c.a.createElement("div",{className:"cricket-cell cricket-nameplate ".concat(l?"cricket-winner":"")},r&&c.a.createElement("span",{className:"cricket-cpu-icon"},function(e){switch(e){case"easy":return"\ud83d\udcbb";case"medium":return"\ud83e\udd16";case"hard":return"\ud83d\udc7e";default:return""}}(r)),t&&c.a.createElement(B,{changeName:t,value:n}),!t&&n,u&&c.a.createElement("div",{className:"cricket-leader",title:"Throwing first this leg"})),c.a.createElement("div",{className:"cricket-cell cricket-legs"},o),a.map((function(e,t){return c.a.createElement(I,{key:t,marks:e,sector:t})})),c.a.createElement("div",{className:"cricket-cell cricket-points ".concat(i?"cricket-points-trailing":"")},s))},K=function(e){var t=e.title;return c.a.createElement("div",{className:"cricket-center"},c.a.createElement("div",{className:"cricket-center-cell center-7"},t),c.a.createElement("div",{className:"cricket-center-cell center-2"},"Legs"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"20"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"19"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"18"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"17"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"16"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"15"),c.a.createElement("div",{className:"cricket-center-cell center-1"},"B"),c.a.createElement("div",{className:"cricket-center-cell center-3"},"Points"))},A=(r(85),function(e){var t=e.state;if(0===t.priorTurns.length)return c.a.createElement("div",{className:"last-turn"});var r=t.priorTurns[t.priorTurns.length-1],n=t.players[(t.currentThrow+1)%t.players.length].name;switch(t.game){case"cricket":var a=r.filter((function(e){return e.eM})).map((function(e){return e.display})).join(", "),s=r.reduce((function(e,t){return e+(t.eM||0)}),0);return c.a.createElement("div",{className:"last-turn"},c.a.createElement("strong",null,"Last Turn: "),n," (",a.length?"".concat(a," -- "):"",s," mark",1===s?"":"s",")");case"x01":return c.a.createElement("div",{className:"last-turn"},c.a.createElement("strong",null,"Last Turn: "),n," (",r.score,")");default:return c.a.createElement("div",{className:"last-turn"})}}),V=(r(86),function(e){var t=e.spectating,r=e.state,n=e.changeName;return c.a.createElement("div",{className:"cricket-scoreboard"},c.a.createElement(L,{currentThrow:r.currentThrow,winner:null!==r.winner}),c.a.createElement("div",{className:"cricket-content"},c.a.createElement(K,{title:r.title}),c.a.createElement(F,{changeName:!t&&function(e){return n(e,0)},name:r.players[0].name,cpu:r.players[0].cpu,marks:r.scores[0].marks,points:r.scores[0].points,legs:r.legs[0],firstThrow:0===r.firstThrow,trailing:r.scores[0].points<r.scores[1].points,winner:0===r.winner}),c.a.createElement(F,{changeName:!t&&function(e){return n(e,1)},name:r.players[1].name,cpu:r.players[1].cpu,marks:r.scores[1].marks,points:r.scores[1].points,legs:r.legs[1],firstThrow:1===r.firstThrow,trailing:r.scores[0].points>r.scores[1].points,winner:1===r.winner}),c.a.createElement(A,{state:r})))}),U=function(e){var t=e.sector,r=e.display,n=e.closed,a=e.isBull,s=e.clickDart;return c.a.createElement("div",{className:"cricket-sector ".concat(n?"cricket-sector-closed":"")},c.a.createElement("div",{className:"cricket-sector-label"},r),c.a.createElement("div",{className:"cricket-sector-buttons"},!n&&c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"cricket-button cricket-button-single",onClick:function(){s({sector:t,multiple:1,display:"".concat(r)})}},"".concat(r)),c.a.createElement("button",{className:"cricket-button cricket-button-double",onClick:function(){s({sector:t,multiple:2,display:"D".concat(r)})}},"D".concat(r)),!a&&c.a.createElement("button",{className:"cricket-button cricket-button-treble",onClick:function(){s({sector:t,multiple:3,display:"T".concat(r)})}},"T".concat(r)))))},G=function(e){var t=e.winner,r=e.spectating,n=e.throwerName,a=e.throwerTeam,s=e.darts,o=e.clickBack,u=e.clickNext;return s=Array.from(Array(3),(function(e,t){return s[t]||{miss:!0}})),c.a.createElement("div",{className:"cricket-current"},null===t&&c.a.createElement("div",{className:"cricket-current-thrower cricket-current-thrower-".concat(a)},c.a.createElement("strong",null,"Current Turn:")," ",n),!r&&c.a.createElement("button",{className:"cricket-current-button cricket-current-back",onClick:o},"Back"),null===t&&s.map((function(e,t){return c.a.createElement("div",{className:"cricket-current-dart ".concat(e.multiple?"cricket-current-dart-".concat(e.multiple):""),key:t},e.display)})),!r&&c.a.createElement("button",{className:"cricket-current-button cricket-current-next",onClick:u},"Next"))},H=(r(87),function(e){var t=e.state,r=e.clickBack,n=e.clickNext,a=e.clickDart,s=e.spectating;return c.a.createElement("div",{className:"cricket-actions"},!s&&["20","19","18","17","16","15","B"].map((function(e,r){var n=t.scores[0].marks[r]>=3&&t.scores[1].marks[r]>=3,s="B"===e;return c.a.createElement(U,{key:r,sector:r,closed:n,display:e,isBull:s,clickDart:a})})),c.a.createElement(G,{spectating:s,winner:t.winner,throwerTeam:t.currentThrow,throwerName:t.players[t.currentThrow].name,clickBack:r,clickNext:n,darts:t.currentTurn}))}),J=(r(88),function(e){var t=e.title,r=e.active,n=e.clickPane;return c.a.createElement("div",{onClick:n,className:"tab ".concat(r?"tab-active":"")},t)}),W=r(3),Y=(r(89),function(e){var t=e.number,r=e.winner,n=e.isBreak,a=e.scores;return c.a.createElement("div",{className:"cricket-log-leg"},c.a.createElement("div",{className:"cricket-log-number"},"Leg ",t),c.a.createElement("div",{className:"cricket-log-winner"},"Winner: ",r),n&&c.a.createElement("div",{className:"cricket-log-break"},"Break"),c.a.createElement("div",{className:"cricket-log-scores"},a[0]," - ",a[1]))}),X=function(e){var t=e.darts,r=e.name,n=e.round,a=e.color,s=t.reduce((function(e,t){return e+t.eM}),0),o=t.filter((function(e){return 6===e.sector})).reduce((function(e,t){return e+t.eM}),0);return c.a.createElement("div",{className:"cricket-log-turn"},c.a.createElement("div",{className:"cricket-log-color cricket-log-color-".concat(a)}),c.a.createElement("div",{className:"cricket-log-round"},r,", Turn ",n),s>=4&&c.a.createElement("div",{className:"cricket-log-marks"},s," Marks"),s<4&&o>=2&&c.a.createElement("div",{className:"cricket-log-bulls"},o," Bulls"),c.a.createElement("div",{className:"cricket-log-darts"},t.map((function(e,t){return e.miss?c.a.createElement("div",{key:t,className:"cricket-log-dart cricket-log-dart-miss"}):c.a.createElement("div",{key:t,className:"cricket-log-dart cricket-log-dart-".concat(e.multiple)},e.display)}))))},Z=function(e){var t=e.state,r=Object(W.a)(t.priorTurns).reverse(),n=Object(W.a)(t.priorLegs).reverse();return c.a.createElement("div",{className:"cricket-log"},r.map((function(e,n){var a=(t.firstThrow+(r.length-n+1))%2;return c.a.createElement(X,{key:n,round:Math.ceil((r.length-n)/2),darts:e,name:t.players[a].name,color:0===a?"red":"blue"})})),n.map((function(e,r){return c.a.createElement(Y,{number:n.length-r,winner:t.players[e.winner].name,scores:e.score,isBreak:e.break,key:r})})))},q=(r(90),function(e){var t=e.table;return c.a.createElement("table",{className:"stat-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,t.header.map((function(e,t){return c.a.createElement("th",{key:t},e)})))),c.a.createElement("tbody",null,t.rows.map((function(e,t){return c.a.createElement("tr",{key:t},e.map((function(e,t){return c.a.createElement("td",{key:t},e)})))}))))}),z=function(e){var t=e.tables;return c.a.createElement("div",{className:"stat-sheet"},t.map((function(e,t){return c.a.createElement(q,{table:e,key:t})})))},Q=function(e){var t=e.state,r=[{header:["","MPR","Hit %"],rows:t.players.map((function(e,r){return[e.name,t.stats[r].mpr.toFixed(2),(100*t.stats[r].hitRate).toFixed(2)+"%"]}))},{header:["","3M+","5M+","7M+"],rows:t.players.map((function(e,r){var n=t.stats[r].turns.map((function(e,t,r){return function(e){return e.reduce((function(e,t){return e+t}),0)}(r.slice(t))}));return[e.name,n[3],n[5],n[7]]}))}];return c.a.createElement(z,{tables:r})},$=(r(91),function(e){var t=e.variants;return 0===Object.keys(t).length?null:c.a.createElement("div",{className:"cricket-menu-variants"},Object.entries(t).map((function(e){var t=Object(n.a)(e,2),r=t[0],a=t[1];return c.a.createElement("p",null,c.a.createElement("strong",null,C(r),":")," ",C(a))})))}),ee=function(e){var t=e.action,r=e.title,n=e.description;return c.a.createElement("div",{className:"danger-option"},c.a.createElement("div",{className:"danger-description"},n),c.a.createElement("button",{onClick:t,className:"danger-title"},r))},te=function(e){var t=e.state,r=e.changeFirstThrow,n=e.restartMatch,a=e.restartLeg;return c.a.createElement("div",{className:"cricket-menu-danger"},c.a.createElement(ee,{title:"Change First Thrower",description:"Changes the first thrower for this leg. Restarts any leg in progress.",action:function(){return r((t.firstThrow+1)%2)}}),c.a.createElement(ee,{title:"Restart Leg",description:"Restarts this leg from the beginning.",action:a}),c.a.createElement(ee,{title:"Restart Match",description:"Restarts this match from the beginning.",action:n}))},re=function(e){var t=e.state,r=e.changeFirstThrow,n=e.restartMatch,a=e.restartLeg,s=e.spectating;return c.a.createElement("div",{className:"cricket-menu"},c.a.createElement($,{variants:t.variants}),c.a.createElement("a",{href:"/"},"Select (or create) a new room"),!s&&c.a.createElement(te,{state:t,changeFirstThrow:r,restartMatch:n,restartLeg:a}))},ne=(r(92),function(e){var t=e.currentPane,r=e.state;switch(t){case 1:return c.a.createElement(Z,{state:r});case 2:return c.a.createElement(re,e);case 0:default:return c.a.createElement(Q,{state:r})}}),ae=function(e){var t=c.a.useState(0),r=Object(n.a)(t,2),a=r[0],s=r[1];return c.a.createElement("div",{className:"tab-container"},c.a.createElement("div",{className:"tab-header"},["Stats","Log","Menu"].map((function(e,t){return c.a.createElement(J,{key:t,title:e,active:t===a,clickPane:function(){return s(t)}})}))),c.a.createElement("div",{className:"tab-content"},c.a.createElement(ne,Object.assign({currentPane:a},e))))},ce=function(e,t){switch(e){case"no-points":return 0;case"standard":default:return[20,19,18,17,16,15,25].reduce((function(e,r,n){return e+Math.max(0,t[n]-3)*r}),0)}},se=function(e){var t=e.marks,r=e.darts,n=e.hits;return{darts:r,marks:t,hits:n,turns:e.turns,mpr:t/(r||1)*3,hitRate:n/(r||1)}},oe=function(e,t){var r=e.darts,n=e.hits,a=e.marks,c=Object(W.a)(e.turns),s=t.reduce((function(e,t){return t.miss?e:e+t.eM}),0);return r-=3,a-=s,n-=t.reduce((function(e,t){return t.miss?e:e+1}),0),c[s]-=1,se({darts:r,marks:a,hits:n,turns:c})},ue=function(e,t){var r=e.variants.format||"standard",n={points:e.scores[e.currentThrow].points,marks:Object(W.a)(e.scores[e.currentThrow].marks)},a=e.scores[(e.currentThrow+1)%2],c=Array.from(Array(3),(function(t,c){var s=e.currentTurn[c];if(void 0===s||null===s)return{miss:!0,eM:0};if(a.marks[s.sector]>=3||"no-points"===r){var o=Math.min(s.multiple,3-Math.min(3,n.marks[s.sector]));return n.marks[s.sector]+=o,Object(l.a)({},s,{eM:o})}return n.marks[s.sector]+=s.multiple,Object(l.a)({},s,{eM:s.multiple})}));n.points=ce(r,n.marks);var s=e.scores.map((function(t,r){return r===e.currentThrow?n:t})),o=e.stats.map((function(t,r){return r===e.currentThrow?function(e,t){var r=e.darts,n=e.hits,a=e.marks,c=Object(W.a)(e.turns),s=t.reduce((function(e,t){return t.miss?e:e+t.eM}),0);return r+=3,a+=s,n+=t.reduce((function(e,t){return t.miss||0===t.eM?e:e+1}),0),c[s]+=1,se({darts:r,marks:a,hits:n,turns:c})}(t,c):t})),u=(e.currentThrow+1)%2,i=function(e,t){return"test"===e?t[0].points>=4?0:t[1].points>=4?1:null:t[0].marks.every((function(e){return e>=3}))&&t[0].points>=t[1].points?0:t[1].marks.every((function(e){return e>=3}))&&t[1].points>=t[0].points?1:null}(r,s);return Object(l.a)({},e,{tx:e.tx+1,priorTurns:[].concat(Object(W.a)(e.priorTurns),[c]),currentTurn:[],currentThrow:u,scores:s,stats:o,winner:i,cpuControl:!!e.players[u].cpu&&null===i})},ie=function(e,t){var r=e.priorTurns.reduce((function(t,r,n){var a=(e.firstThrow+n)%2;return t.map((function(e,t){return t===a?oe(e,r):e}))}),e.stats);return Object(l.a)({},e,{tx:e.tx+1,stats:r,currentThrow:e.firstThrow,currentTurn:[],priorTurns:[],scores:[{points:0,marks:[0,0,0,0,0,0,0]},{points:0,marks:[0,0,0,0,0,0,0]}],winner:null})},le=function(e,t){switch(t.type){case"update_state":return function(e,t){return t.state}(0,t);case"click_dart":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,currentTurn:e.currentTurn.concat(t.dart)})}(e,t);case"key_backspace":case"click_back":return e.currentTurn.length>0?function(e,t){return Object(l.a)({},e,{tx:e.tx+1,currentTurn:e.currentTurn.slice(0,-1)})}(e):function(e,t){if(0===e.priorTurns.length)return e;var r={points:e.scores[(e.currentThrow+1)%2].points,marks:Object(W.a)(e.scores[(e.currentThrow+1)%2].marks)},n=e.priorTurns.slice(-1)[0],a=n.filter((function(e){return!0!==e.miss}));a.forEach((function(e){r.marks[e.sector]-=e.eM})),r.points=ce(e.variants.format,r.marks);var c=e.scores.map((function(t,n){return n!==e.currentThrow?r:t})),s=e.stats.map((function(t,r){return r!==e.currentThrow?oe(t,n):t}));return Object(l.a)({},e,{tx:e.tx+1,priorTurns:e.priorTurns.slice(0,-1),currentTurn:a,currentThrow:(e.currentThrow+1)%2,scores:c,stats:s,winner:null})}(e);case"key_enter":case"click_next":return null!==e.winner?function(e,t){var r=e.legs.map((function(t,r){return r===e.winner?t+1:t})),n=(e.firstThrow+1)%2,a={winner:e.winner,break:e.winner!==e.firstThrow,score:e.scores.map((function(e){return e.points}))},c=e.priorLegs.concat(a);return Object(l.a)({},e,{tx:e.tx+1,legs:r,priorLegs:c,priorTurns:[],firstThrow:n,currentThrow:n,currentTurn:[],scores:[{points:0,marks:[0,0,0,0,0,0,0]},{points:0,marks:[0,0,0,0,0,0,0]}],winner:null,cpuControl:!!e.players[n].cpu})}(e):ue(e);case"change_name":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,players:e.players.map((function(e,r){return r===t.player?Object(l.a)({},e,{name:t.name}):e}))})}(e,t);case"click_change_first_throw":return function(e,t){var r=ie(e);return Object(l.a)({},r,{firstThrow:t.firstThrow,currentThrow:t.firstThrow})}(e,t);case"click_restart_leg":return ie(e);case"click_restart_match":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,legs:[0,0],stats:[{darts:0,marks:0,hits:0,turns:Array.from(Array(10),(function(e){return 0})),mpr:0,hitRate:0},{darts:0,marks:0,hits:0,turns:Array.from(Array(10),(function(e){return 0})),mpr:0,hitRate:0}],scores:[{points:0,marks:[0,0,0,0,0,0,0]},{points:0,marks:[0,0,0,0,0,0,0]}],firstThrow:0,currentThrow:0,priorTurns:[],priorLegs:[],currentTurn:[],winner:null})}(e);default:return e}},me=function(e){var t=e.scores[e.currentThrow],r=e.scores[(e.currentThrow+1)%2],n=t.marks.findIndex((function(e,t){return e>=3&&r.marks[t]<3})),a=t.marks.findIndex((function(e,t){return e<3&&r.marks[t]<3})),c=t.marks.findIndex((function(e){return e<3})),s=function(e){if(e.length)return e[Math.floor(Math.random()*e.length)]}(t.marks.reduce((function(e,t,n){return(t<3||t>=3&&r.marks[n]<3)&&e.push(n),e}),[]));return{score:n>-1?n:a,open:a>-1?a:c,progress:c>-1?c:s,random:s}},de=function(e,t){return 6===e?2===t?"DB":"B":3===t?"T".concat(20-e):2===t?"D".concat(20-e):"".concat(20-e)},pe=function(e){var t=e.players[e.currentThrow].cpu,r=me(e),n=function(e,t,r){switch(e){case"hard":return r>0?Math.random()<.8?t.progress:t.score:Math.random()<.8?t.score:t.open;case"medium":return r<0?Math.random()<.667?t.score:t.open:Math.random()<.667?t.progress:t.score;case"easy":default:return Math.random()<.2?t.random:Math.random()<.3?t.score:t.open}}(t,r,e.scores[e.currentThrow].points-e.scores[(e.currentThrow+1)%2].points);return(-1===n||Math.random()<.035)&&(n=r.random),function(e,t){var r=Math.random(),n=Math.random();switch(e){case"hard":if(6===t&&r<.45){var a=n<.35?2:1;return{sector:t,multiple:a,display:de(t,a)}}if(t<6&&r<.55){var c=n<.2?n<.15?3:2:1;return{sector:t,multiple:c,display:de(t,c)}}return{miss:!0};case"medium":if(6===t&&r<.35){var s=n<.25?2:1;return{sector:t,multiple:s,display:de(t,s)}}if(t<6&&r<.45){var o=n<.15?n<.1?3:2:1;return{sector:t,multiple:o,display:de(t,o)}}return{miss:!0};case"easy":default:if(6===t&&r<.25){var u=n<.15?2:1;return{sector:t,multiple:u,display:de(t,u)}}if(t<6&&r<.38){var i=n<.09?n<.04?3:2:1;return{sector:t,multiple:i,display:de(t,i)}}return{miss:!0}}}(t,n)},fe=(r(93),function(){var e=Object(j.a)(x.a.mark((function e(t,r){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.currentTurn.length;case 1:if(!(n<3)){e.next=8;break}return e.next=4,O(500);case 4:r({type:"click_dart",dart:pe(t)});case 5:n++,e.next=1;break;case 8:return e.next=10,O(500);case 10:r({type:"click_next"});case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),he=function(e){var t=c.a.useReducer(le,e.state),r=Object(n.a)(t,2),a=r[0],s=r[1],o=c.a.useState(!1),u=Object(n.a)(o,2),i=u[0],l=u[1];c.a.useEffect((function(){e.state&&s({type:"update_state",state:e.state})}),[e.state]),c.a.useEffect((function(){window.document.title="[".concat(a.roomCode,"] ").concat(a.players[0].name," ").concat(a.legs[0],"-").concat(a.legs[1]," ").concat(a.players[1].name)}),[a.roomCode,a.players,a.legs]),c.a.useEffect((function(){var e=function(e){switch(e.code){case"Enter":return e.preventDefault(),void d({type:"key_enter"});case"Backspace":return void d({type:"key_backspace"});default:return}};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}));var m=function(t){if(!i){var r=le(a,t);r&&(e.updateState(r),s(t))}},d=function(e){a.cpuControl||m(e)};return c.a.useEffect((function(){a.cpuControl&&null===a.winner&&fe(a,m)}),[a.cpuControl,a.winner,a.currentThrow]),c.a.createElement("div",{className:"cricket-container"},c.a.createElement("div",{className:"cricket-spectate-container"},c.a.createElement(S,{spectating:i,clickChange:function(){return l(!i)}})),c.a.createElement("div",{className:"cricket-scoreboard-container"},c.a.createElement(V,{spectating:i,state:a,changeName:function(e,t){return d({type:"change_name",name:e,player:t})}})),c.a.createElement("div",{className:"cricket-actions-container"},c.a.createElement(H,{spectating:i,state:a,clickDart:function(e){return d({type:"click_dart",dart:e})},clickBack:function(){return d({type:"click_back"})},clickNext:function(){return d({type:"click_next"})}})),c.a.createElement("div",{className:"cricket-tabs-container"},c.a.createElement(ae,{state:a,spectating:i,changeFirstThrow:function(e){return d({type:"click_change_first_throw",firstThrow:e})},restartLeg:function(){return d({type:"click_restart_leg"})},restartMatch:function(){return d({type:"click_restart_match"})}})))},ve=function(e){var t=e.title;return c.a.createElement("div",{className:"x01-center"},c.a.createElement("div",{className:"x01-center-cell center-13"},t),c.a.createElement("div",{className:"x01-center-cell center-3"},"Legs"),c.a.createElement("div",{className:"x01-center-cell center-3"},"Points"))},be=function(e){var t=e.value,r=e.changeName;return c.a.createElement("input",{className:"x01-name",value:t,onChange:function(e){return r(e.target.value)}})},ke=function(e){var t=e.name,r=e.legs,n=e.score,a=e.winner,s=e.firstThrow,o=e.changeName;return c.a.createElement("div",{className:"x01-player"},c.a.createElement("div",{className:"x01-cell x01-nameplate ".concat(a?"x01-winner":"")},o&&c.a.createElement(be,{changeName:o,value:t}),!o&&t,s&&c.a.createElement("div",{className:"x01-leader",title:"Throwing first this leg"})),c.a.createElement("div",{className:"x01-cell x01-legs"},r),c.a.createElement("div",{className:"x01-cell x01-points"},n))},ge=(r(94),function(e){var t=e.state,r=e.spectating,n=e.changeName,a=c.a.useRef(null);return c.a.useEffect((function(){var e=function(e){return e.stopPropagation()},t=a.current;return t&&t.addEventListener("keyup",e),function(){return t&&t.removeEventListener("keyup",e)}}),[a]),c.a.createElement("div",{ref:a,className:"x01-scoreboard x01-scoreboard-players-".concat(t.players.length)},c.a.createElement(L,{currentThrow:t.currentThrow,winner:null!==t.winner}),c.a.createElement("div",{className:"x01-content"},c.a.createElement(ve,{title:t.title}),t.players.map((function(e,a){return c.a.createElement(ke,{key:a,changeName:!r&&function(e){return n(e,a)},name:e.name,legs:t.legs[a],score:t.scores[a],winner:t.winner===a,firstThrow:t.firstThrow===a})})),c.a.createElement(A,{state:t})))}),Ee=(r(95),function(e){var t=e.text,r=e.currentTurn,n=e.clickDouble,a=e.showZero;return c.a.createElement("div",{className:"x01-action-content"},c.a.createElement("div",{className:"x01-action-text"},t),c.a.createElement("div",{className:"x01-action-buttons"},a&&c.a.createElement("button",{className:"x01-action-button x01-action-button-0 ".concat(0===r.doubleDart?"x01-action-button-active":""),onClick:function(){return n(0)}},"0"),c.a.createElement("button",{className:"x01-action-button x01-action-button-1 ".concat(1===r.doubleDart?"x01-action-button-active":""),onClick:function(){return n(1)}},"1"),c.a.createElement("button",{className:"x01-action-button x01-action-button-2 ".concat(2===r.doubleDart?"x01-action-button-active":""),onClick:function(){return n(2)}},"2"),c.a.createElement("button",{className:"x01-action-button x01-action-button-3 ".concat(3===r.doubleDart?"x01-action-button-active":""),onClick:function(){return n(3)}},"3")))}),ye=function(e){var t=e.inputRef,r=e.spectating,n=e.state,a=e.changeScore,s=e.clickDouble,o=e.clickBack,u=e.clickNext,i=n.variants,l=n.currentTurn,m=n.scores[n.currentThrow],d="yes"===i.trackDoubles,p=d&&"double"===i.start&&m===Number(i.target)&&l.score>0,f=d&&"double"===i.end&&m===Number(l.score)&&""!==l.score,h=d&&"double"===i.end&&m-Number(l.score)<=50&&""!==l.score,v=(p||f||h)&&!1===n.currentTurn.doubleDart;return c.a.createElement("div",{className:"x01-actions"},null===n.winner&&c.a.createElement("div",{className:"x01-current-thrower x01-current-thrower-".concat(n.currentThrow)},c.a.createElement("strong",null,"Current Turn:")," ",n.players[n.currentThrow].name),c.a.createElement("div",{className:"x01-action-score-container"},c.a.createElement("input",{type:"text",className:"x01-action-score",value:l.score,ref:t,onChange:function(e){a(e.target.value)}})),d&&c.a.createElement("div",{className:"x01-action-doubles"},l.score>180&&"...wait, what",p&&c.a.createElement(Ee,{clickDouble:s,currentTurn:l,text:"Which dart did ".concat(n.players[n.currentThrow].name," double in with?")}),h&&c.a.createElement(Ee,{clickDouble:s,currentTurn:l,showZero:!0,text:"How many darts did ".concat(n.players[n.currentThrow].name," miss at double?")})),!r&&c.a.createElement("div",{className:"x01-action-current"},c.a.createElement("button",{className:"x01-current-button x01-current-back",onClick:o},"Back"),c.a.createElement("button",{disabled:v||null===n.winner&&""===n.currentTurn.score,className:"x01-current-button x01-current-next",onClick:u},"Next")))},we=(r(96),function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return 0===t?"--":0===e?"".concat(e,"/").concat(t):(e/t).toFixed(r)}),Ne=function(e){var t=e.state,r=[{header:["","Average","First 9"],rows:t.players.map((function(e,r){var n=t.stats[r],a=we(n.all.points,n.all.darts/3),c=we(n.f9.points,n.f9.darts/3);return[e.name,a,c]}))},{header:["","90+","130+","170+"],rows:t.players.map((function(e,r){var a=t.stats[r],c=Object.entries(a.turns).reduce((function(e,t){var r=Object(n.a)(t,2),a=r[0],c=r[1];return Number(a)>=90&&(e[90]+=c,Number(a)>=130&&(e[130]+=c,Number(a)>=170&&(e[170]+=c))),e}),{90:0,130:0,170:0});return[e.name,c[90],c[130],c[170]]}))},{header:["","Avg Out","High Out"],rows:t.players.map((function(e,r){var n=t.stats[r];return[e.name,we(n.checkouts.reduce((function(e,t){return e+t}),0),n.checkouts.length),n.checkouts.reduce((function(e,t){return t>e?t:e}),0)||"--"]}))}];if("yes"===t.variants.trackDoubles){var a="double"===t.variants.start,s="double"===t.variants.end,o=["Doubles"];a&&o.push("In %"),s&&o.push("Out %"),r.push({header:o,rows:t.players.map((function(e,r){var n=[e.name],c=t.stats[r];return a&&n.push(we(100*c.doubleIn.hits,c.doubleIn.hits+c.doubleIn.misses,1)),s&&n.push(we(100*c.doubleOut.hits,c.doubleOut.hits+c.doubleOut.misses,1)),n}))})}return c.a.createElement("div",{className:"x01-stats"},c.a.createElement(z,{tables:r}))},Te=(r(97),function(e){var t=e.number,r=e.winner,n=e.isBreak,a=e.checkout;return c.a.createElement("div",{className:"x01-log-leg"},c.a.createElement("div",{className:"x01-log-number"},"Leg ",t),c.a.createElement("div",{className:"x01-log-winner"},"Winner: ",r),n&&c.a.createElement("div",{className:"x01-log-break"},"Break"),c.a.createElement("div",{className:"x01-log-checkout"},"Checkout: ",a))}),xe=function(e){return e>=170?"red":e>=130?"blue":e>=90?"purple":void 0},je=function(e){var t=e.name,r=e.round,n=e.score,a=e.thrower,s=e.remaining;return c.a.createElement("div",{className:"x01-log-turn ".concat(0===s[a]?"x01-log-turn-winner":"")},c.a.createElement("div",{className:"x01-log-round"},t,", Turn ",r),c.a.createElement("div",{className:"x01-log-score x01-log-score-".concat(xe(n))},n),c.a.createElement("div",{className:"x01-log-scores"},s.map((function(e,t){return c.a.createElement("div",{key:t,className:"x01-log-remaining x01-log-remaining-".concat(Oe(t)," ").concat(a===t?"x01-log-remaining-active":"")},e)}))))},Oe=function(e){switch(e){case 0:return"red";case 1:return"blue";case 2:return"green";case 3:return"orange";case 4:return"purple";case 5:return"pink";default:return""}},Ce=function(e){var t=e.state,r=Object(W.a)(t.priorTurns).reverse(),n=Object(W.a)(t.priorLegs).reverse();return c.a.createElement("div",{className:"x01-log"},r.map((function(e,r){return c.a.createElement(je,{key:r,name:t.players[e.throw].name,round:e.round+1,score:e.score,remaining:e.remaining,thrower:e.throw})})),n.map((function(e,r){return c.a.createElement(Te,{key:r,idx:r,number:r+1,winner:t.players[e.winner].name,isBreak:e.break,checkout:e.turns[e.winner].slice(-1)[0]})})))},_e=(r(98),function(e){var t=e.variants;return c.a.createElement("div",{className:"x01-menu-variants"},c.a.createElement("p",null,c.a.createElement("strong",null,"Target:")," ",t.target),"yes"===t.trackDoubles&&c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,c.a.createElement("strong",null,"Double In:")," ","double"===t.start?"Yes":"No"),c.a.createElement("p",null,c.a.createElement("strong",null,"Double Out:")," ","double"===t.end?"Yes":"No")))}),De=function(e){var t=e.action,r=e.title,n=e.description;return c.a.createElement("div",{className:"danger-option"},c.a.createElement("div",{className:"danger-description"},n),c.a.createElement("button",{onClick:t,className:"danger-title"},r))},Re=function(e){var t=e.state,r=e.changeFirstThrow,n=e.restartMatch,a=e.restartLeg;return c.a.createElement("div",{className:"x01-menu-danger"},c.a.createElement(De,{title:"Change First Thrower",description:"Changes the first thrower for this leg. Restarts any leg in progress.",action:function(){return r((t.firstThrow+1)%t.players.length)}}),c.a.createElement(De,{title:"Restart Leg",description:"Restarts this leg from the beginning.",action:a}),c.a.createElement(De,{title:"Restart Match",description:"Restarts this match from the beginning.",action:n}))},Me=function(e){var t=e.state,r=e.changeFirstThrow,n=e.restartMatch,a=e.restartLeg,s=e.spectating;return c.a.createElement("div",{className:"x01-menu"},c.a.createElement(_e,{variants:t.variants}),c.a.createElement("a",{href:"/"},"Select (or create) a new room"),!s&&c.a.createElement(Re,{state:t,changeFirstThrow:r,restartMatch:n,restartLeg:a}))},Se=function(e){var t=e.currentPane,r=e.state;switch(t){case 1:return c.a.createElement(Ce,{state:r});case 2:return c.a.createElement(Me,e);case 0:default:return c.a.createElement(Ne,{state:r})}},Le=function(e){var t=c.a.useState(0),r=Object(n.a)(t,2),a=r[0],s=r[1];return c.a.createElement("div",{className:"tab-container"},c.a.createElement("div",{className:"tab-header"},["Stats","Log","Menu"].map((function(e,t){return c.a.createElement(J,{key:t,title:e,active:t===a,clickPane:function(){return s(t)}})}))),c.a.createElement("div",{className:"tab-content"},c.a.createElement(Se,Object.assign({currentPane:a},e))))},Pe=r(7),Be=function(e,t){return e.map((function(e,r){if(r!==t.throw)return e;var n=t.darts,a=t.doubling,c=t.missedDoubles,s=t.score,o=t.round,u=t.checkout;return{all:{darts:e.all.darts-n,points:e.all.points-s},f9:{darts:e.f9.darts-(o<3?n:0),points:e.f9.points-(o<3?s:0)},turns:Object(l.a)({},e.turns,Object(Pe.a)({},s,(e.turns[s]||0)-1)),checkouts:u?Object(W.a)(e.checkouts.slice(0,-1)):Object(W.a)(e.checkouts),doubleIn:{misses:e.doubleIn.misses-("in"===a?c:0),hits:e.doubleIn.hits-("in"===a&&s>0?1:0)},doubleOut:{misses:e.doubleOut.misses-("out"===a?c:0),hits:e.doubleOut.hits-("out"===a&&u?1:0)}}}))},Ie=function(e,t){var r=e.variants,n=e.scores[e.currentThrow],a=Number(e.currentTurn.score);(n<a||n-a===1)&&(a=0);var c=e.scores.map((function(t,r){return r===e.currentThrow?t-a:t})),s={throw:e.currentThrow,round:Math.floor(e.priorTurns.length/e.players.length),darts:3,remaining:Object(W.a)(c),score:a,doubling:!1,missedDoubles:0};n===a&&(s.checkout=!0),"yes"===r.trackDoubles&&(n===Number(r.target)&&"double"===r.start&&(s.doubling="in",s.missedDoubles=0===a?3:(e.currentTurn.doubleDart||1)-1),"double"===r.end&&n-a<=50&&(s.doubling="out",s.missedDoubles=e.currentTurn.doubleDart));var o=e.priorTurns.concat(s),u=function(e,t){return e.map((function(e,r){if(r!==t.throw)return e;var n=t.darts,a=t.doubling,c=t.missedDoubles,s=t.score,o=t.round,u=t.checkout;return{all:{darts:e.all.darts+n,points:e.all.points+s},f9:{darts:e.f9.darts+(o<3?n:0),points:e.f9.points+(o<3?s:0)},turns:Object(l.a)({},e.turns,Object(Pe.a)({},s,(e.turns[s]||0)+1)),checkouts:u?[].concat(Object(W.a)(e.checkouts),[s]):Object(W.a)(e.checkouts),doubleIn:{misses:e.doubleIn.misses+("in"===a?c:0),hits:e.doubleIn.hits+("in"===a&&s>0?1:0)},doubleOut:{misses:e.doubleOut.misses+("out"===a?c:0),hits:e.doubleOut.hits+("out"===a&&u?1:0)}}}))}(e.stats,s);return Object(l.a)({},e,{tx:e.tx+1,scores:c,stats:u,currentThrow:(e.currentThrow+1)%e.players.length,currentTurn:{score:"",doubleDart:!1},priorTurns:o,winner:n===a?e.currentThrow:null})},Fe=function(e,t){var r=e.legs.map((function(t,r){return r===e.winner?t+1:t})),n=(e.firstThrow+1)%e.players.length,a={winner:e.winner,break:e.winner!==e.firstThrow,score:Object(W.a)(e.scores),turns:e.priorTurns.reduce((function(e,t){return e[t.throw]=e[t.throw].concat(t.score),e}),e.players.map((function(e){return[]})))},c=e.priorLegs.concat(a);return Object(l.a)({},e,{tx:e.tx+1,legs:r,firstThrow:n,priorLegs:c,priorTurns:[],currentThrow:n,currentTurn:{score:"",doubleDart:!1},scores:e.players.map((function(t){return Number(e.variants.target)})),winner:null})},Ke=function(e,t){if(0===e.priorTurns.length)return e;var r=e.priorTurns.slice(-1)[0],n=e.scores.map((function(e,t){return t===r.throw?e+r.score:e})),a={score:r.score.toString(),doubleDart:r.missedDoubles},c=e.priorTurns.slice(0,-1),s=Be(e.stats,r);return Object(l.a)({},e,{tx:e.tx+1,scores:n,stats:s,currentThrow:r.throw,currentTurn:a,priorTurns:c,winner:null})},Ae=function(e,t){var r=e.priorTurns.reduce((function(e,t){return Be(e,t)}),e.stats);return Object(l.a)({},e,{tx:e.tx+1,stats:r,scores:e.players.map((function(t){return Number(e.variants.target)})),currentThrow:e.firstThrow,currentTurn:{score:"",doubleDart:!1},priorTurns:[],winner:null,cpuControl:!!e.players[e.firstThrow].cpu})},Ve=function(){return{all:{darts:0,points:0},f9:{darts:0,points:0},turns:{},checkouts:[],doubleIn:{misses:0,hits:0},doubleOut:{misses:0,hits:0}}},Ue=function(e,t){switch(t.type){case"update_state":return t.state;case"change_name":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,players:e.players.map((function(e,r){return r===t.player?Object(l.a)({},e,{name:t.name}):e}))})}(e,t);case"change_score":return function(e,t){return isNaN(t.score)||Number(t.score)>180||t.score.includes("-")?e:Object(l.a)({},e,{tx:e.tx+1,currentTurn:Object(l.a)({},e.currentTurn,{score:Number(t.score)})})}(e,t);case"click_double":return Object(l.a)({},e,{tx:e.tx+1,currentTurn:Object(l.a)({},e.currentTurn,{doubleDart:t.double})});case"click_next":return null===e.winner?Ie(e):Fe(e);case"click_back":return Ke(e);case"click_change_first_throw":return function(e,t){var r=Ae(e);return Object(l.a)({},r,{firstThrow:t.firstThrow,currentThrow:t.firstThrow})}(e,t);case"click_restart_leg":return Ae(e);case"click_restart_match":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,legs:e.players.map((function(e){return 0})),scores:e.players.map((function(t){return Number(e.variants.target)})),stats:e.players.map(Ve),firstThrow:0,currentThrow:0,priorTurns:[],priorLegs:[],currentTurn:{score:"",doubleDart:!1},winner:null,cpuControl:!!e.players[0].cpu})}(e);case"key_number":return function(e,t){return Object(l.a)({},e,{tx:e.tx+1,currentTurn:Object(l.a)({},e.currentTurn,{score:Number(e.currentTurn.score+t.digit)})})}(e,t);case"key_enter":return function(e,t){var r=e.variants,n=e.currentTurn,a=e.scores[e.currentThrow],c="yes"===r.trackDoubles,s=c&&"double"===r.start&&a===Number(r.target)&&n.score>0,o=c&&"double"===r.end&&a===Number(n.score)&&""!==n.score,u=c&&"double"===r.end&&a-Number(n.score)<=50&&""!==n.score;return""===e.currentTurn.score||(s||o||u)&&!1===e.currentTurn.doubleDart?e:null===e.winner?Ie(e):Fe(e)}(e);case"key_backspace":return""===e.currentTurn.score?Ke(e):function(e,t){return Object(l.a)({},e,{tx:e.tx+1,currentTurn:Object(l.a)({},e.currentTurn,{score:e.currentTurn.score.split("").slice(0,-1).join("")})})}(e);default:return e}},Ge=(r(99),function(e){var t=c.a.useReducer(Ue,e.state),r=Object(n.a)(t,2),a=r[0],s=r[1],o=c.a.useState(!1),u=Object(n.a)(o,2),i=u[0],l=u[1],m=c.a.useRef(null);c.a.useEffect((function(){e.state&&s({type:"update_state",state:e.state})}),[e.state]),c.a.useEffect((function(){2===a.players.length?window.document.title="[".concat(a.roomCode,"] ").concat(a.players[0].name," ").concat(a.legs[0],"-").concat(a.legs[1]," ").concat(a.players[1].name):window.document.title="[".concat(a.roomCode,"] Live Darts Scoring")}),[a.roomCode,a.players,a.legs]),c.a.useEffect((function(){var e=function(e){switch(e.code){case"Digit0":case"Digit1":case"Digit2":case"Digit3":case"Digit4":case"Digit5":case"Digit6":case"Digit7":case"Digit8":case"Digit9":return void(document.activeElement!==m.current&&(m.current.focus(),d({type:"key_number",digit:e.key})));case"Enter":return e.preventDefault(),void d({type:"key_enter"});default:return}};return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}}));var d=function(t){if(!i){var r=Ue(a,t);r&&(e.updateState(r),s(t))}};return c.a.createElement("div",{className:"x01-container"},c.a.createElement("div",{className:"x01-spectate-container"},c.a.createElement(S,{spectating:i,clickChange:function(){return l(!i)}})),c.a.createElement("div",{className:"x01-scoreboard-container"},c.a.createElement(ge,{spectating:i,state:a,changeName:function(e,t){return d({type:"change_name",name:e,player:t})}})),c.a.createElement("div",{className:"x01-actions-container"},c.a.createElement(ye,{spectating:i,state:a,changeScore:function(e){return d({type:"change_score",score:e})},clickDouble:function(e){return d({type:"click_double",double:e})},clickNext:function(){return d({type:"click_next"})},clickBack:function(){return d({type:"click_back"})},inputRef:m})),c.a.createElement("div",{className:"x01-tabs-container"},c.a.createElement(Le,{state:a,spectating:i,changeFirstThrow:function(e){return d({type:"click_change_first_throw",firstThrow:e})},restartLeg:function(){return d({type:"click_restart_leg"})},restartMatch:function(){return d({type:"click_restart_match"})}})))}),He=function(e){var t=e.state,r=e.updateState;switch(t.game){case"x01":return c.a.createElement(Ge,{state:t,updateState:r});case"cricket":default:return c.a.createElement(he,{state:t,updateState:r})}},Je=(r(100),function(e,t){switch(t.type){case"update_state":return t.state;default:return e}}),We=function(){return{tx:0,isActive:!1,game:null,variants:null}},Ye=function(e){var t=c.a.useReducer(Je,{},We),r=Object(n.a)(t,2),a=r[0],s=r[1];return c.a.useEffect((function(){e.state&&s({type:"update_state",state:e.state})}),[e.state]),c.a.createElement("div",{className:"app-container"},c.a.createElement("div",{className:"app-content"},a.isActive?c.a.createElement(He,{state:a,updateState:e.sendState}):c.a.createElement(M,{checkRoom:e.checkRoom,roomStatus:e.roomStatus,joinRoom:e.joinRoom,createRoom:e.createRoom})))},Xe=function(e){e.hashObject;var t=e.urlFragment,r=c.a.useReducer(m,function(e){var t=e.urlFragment,r={loading:!1,state:null,publicKey:null,privateKey:null,shortCode:null,roomStatus:{shortCode:null,publicKey:null}};return"room"===t[0]&&t[1]&&(r.loading=t[1]),r}({urlFragment:t})),a=Object(n.a)(r,2),s=a[0],o=a[1],u=c.a.useState(null),l=Object(n.a)(u,2),d=l[0],p=l[1];c.a.useEffect((function(){var e=i()();return e.on("update",(function(e){o({type:"update_state",data:e})})),p(e),function(){e.close()}}),[]),c.a.useEffect((function(){d&&s.shortCode&&window.history.replaceState(null,null,"/room/".concat(s.shortCode))}),[d,s.shortCode]),c.a.useEffect((function(){d&&s.loading&&d.emit("join_short",s.loading,(function(e){o({type:"join_room_response",response:e})}))}),[d,s.loading,s.shortCode]);return c.a.createElement(c.a.Fragment,null,s.loading?null:c.a.createElement(Ye,{sendState:function(e){d.emit("update_channel",{state:e,publicKey:s.publicKey,privateKey:s.privateKey})},checkRoom:function(e){d.emit("validate_short",e,(function(t){o({type:"check_room_response",shortCode:e,publicKey:t.shortCode})}))},joinRoom:function(){s.shortCode&&d.emit("leave_short",s.shortCode),d.emit("join_short",s.roomStatus.shortCode,(function(e){o({type:"join_room_response",response:e})}))},createRoom:function(e){d.emit("create_channel",{shortCode:s.roomStatus.shortCode,state:e,incremental:!0},(function(e){o({type:"create_room_response",response:e})}))},state:s.state,roomStatus:s.roomStatus}))},Ze=(r(101),window.location.pathname.split("/").filter((function(e){return e}))),qe=window.location.hash.split("#")[1],ze=null;qe&&(ze=qe.split("&").reduce((function(e,t){if(!t.includes("="))return""!==t&&(e[t]=!0),e;var r=t.split("="),a=Object(n.a)(r,2),c=a[0],s=a[1];return e[c]=s,e}),{})),o.a.render(c.a.createElement(Xe,{hashObject:ze,urlFragment:Ze}),document.getElementById("root"))},40:function(e,t,r){e.exports=r(102)},74:function(e,t){},77:function(e,t,r){},78:function(e,t,r){},79:function(e,t,r){},80:function(e,t,r){},82:function(e,t,r){},83:function(e,t,r){},84:function(e,t,r){},85:function(e,t,r){},86:function(e,t,r){},87:function(e,t,r){},88:function(e,t,r){},89:function(e,t,r){},90:function(e,t,r){},91:function(e,t,r){},92:function(e,t,r){},93:function(e,t,r){},94:function(e,t,r){},95:function(e,t,r){},96:function(e,t,r){},97:function(e,t,r){},98:function(e,t,r){},99:function(e,t,r){}},[[40,1,2]]]);
//# sourceMappingURL=main.570fe9e0.chunk.js.map